<!DOCTYPE html>
<html lang="en">
<head>
  
  
  
  
  <link rel="stylesheet" href="/littlefoot_12488593780039224145.min.54699eaea8856da92132545b99c00faedb4366ab9b50eb1b1e6856689a884ae1.css" integrity="sha256-VGmerqiFbakhMlRbmcAPrttDZqubUOsbHmhWaJqISuE=" />
  

  <title>Tidying up towing data with Pandas | utf9k</title>
<link rel="alternate" type="text/markdown" href="https://utf9k.net/blog/tidying-towing-data/index.md">
<link rel="alternate" type="text/plain" href="https://utf9k.net/blog/tidying-towing-data/index.txt">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="theme-color" content="#eaebe3" media="(prefers-color-scheme: light)" />
<meta name="theme-color" content="#1f2738" media="(prefers-color-scheme: dark)" />
<meta name="author" content="Marcus Crane" />
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no" />

<meta name="description"
  content="A step by step walkthrough on how I cleaned up some data as part of a side project" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="icon" type="image/png" href="/favicon.png" sizes="16x16">
<link rel="canonical" href="https://utf9k.net/blog/tidying-towing-data/" />
<link rel="apple-touch-icon" href="/favicon.png">
<link rel="me" href="mailto:hello@utf9k.net" />
<link rel="me" href="https://mastodon.nz/@utf9k" />
<link rel="me" href="https://twitter.com/sentreh" />
<link rel="me" href="https://github.com/marcus-crane" />
<link rel="webmention" href="https://webmention.io/utf9k.net/webmention" />
<link rel="pingback" href="https://webmention.io/utf9k.net/xmlrpc" />
<meta property="og:title" content="Tidying up towing data with Pandas" />
<meta property="og:description" content="A step by step walkthrough on how I cleaned up some data as part of a side project" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://utf9k.net/blog/tidying-towing-data/" /><meta property="og:image" content="https://utf9k.net/favicon.png"/><meta property="article:section" content="blog" />
<meta property="article:published_time" content="2020-11-23T00:00:00+13:00" />
<meta property="article:modified_time" content="2023-01-03T14:06:19+13:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://utf9k.net/favicon.png"/>

<meta name="twitter:title" content="Tidying up towing data with Pandas"/>
<meta name="twitter:description" content="A step by step walkthrough on how I cleaned up some data as part of a side project"/>
<meta name="twitter:site" content="@sentreh"/>






<link rel="stylesheet" href="/css/style.min.f927dcb0e4d3990cada1be73573ac4f5fa673a75c7e0fc28d4a7ee01400aeaaf.css" integrity="sha256-+SfcsOTTmQytob5zVzrE9fpnOnXH4Pwo1KfuAUAK6q8=" />

  

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Tidying up towing data with Pandas",
  "datePublished": "2020-11-23T00:00:00-00:00"
}
</script>


</head>
<body>
  
    <header class="navigation">
  <a href="/" id="logo">
    <img src="/favicon.png" alt="utf9k" width="16px" height="16px">
    <span>utf9k</span>
  </a>
  <nav>
    
    
    <li><a href="/blog/">Blog</a></li>
    <span>//</span>
    
    <li><a href="/projects/">Projects</a></li>
    <span>//</span>
    
    <li><a href="/about/">About</a></li>
    <span>//</span>
    
    <li><a href="/questions/">Questions</a></li>
    <span>//</span>
    
    <li><a href="/rss.xml">RSS</a></li>
    
    
  </nav>
</header>
    <div id="content">
    
<article>
  <header>
    <h1>Tidying up towing data with Pandas</h1>
    <div id="post-meta">
      <time datetime="2020-11-23 00:00:00 &#43;1300 NZDT">November 23, 2020</time>  · Around 15 minutes
    </div>
  </header>
  <div id="post-body">
    

<details class="my-5">
  <summary>Table of contents</summary>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#getting-the-data">Getting the data</a></li>
    <li><a href="#parsing-the-data">Parsing the data</a></li>
    <li><a href="#cleaning-up-the-data">Cleaning up the data</a></li>
    <li><a href="#performing-some-data-fixes">Performing some data fixes</a></li>
    <li><a href="#transforming-dates-into-valid-timestamps">Transforming dates into valid timestamps</a>
      <ul>
        <li><a href="#final-cleanup">Final cleanup</a></li>
        <li><a href="#exporting-the-data">Exporting the data</a></li>
      </ul>
    </li>
  </ul>
</nav>
</details>


    <div class="notice">
  <hr class="hidden" />
  <h3>
  I am not a lawyer! Oh, I meant to say data scientist</h3>
<p>I came across this post in an archive folder, fully written out as you see below but never published.</p>
<p>I&rsquo;m not a data analyst or even really proficient in Pandas by any stretch of the imagination so don&rsquo;t take any of the below as best practice.</p>
<p>What I can claim however is that it worked, more or less, so you&rsquo;re welcome to code along.</p>
  <hr class="hidden" />
</div>
<p>This will be a pretty lengthy blog post detailing how I took an XLSX spreadsheet with towing data and cleaned it up to be (mostly) machine readable.</p>
<p>My ultimate goal is to transform it into a fancy data visualisation. I know roughly how to get there but getting there is tedious.</p>
<p>Rather than leave code snippets lying around my hard drive, I&rsquo;ve decided to share what I&rsquo;ve accomplished so far.</p>
<p>That and I&rsquo;m going to forget how to do any of this if I don&rsquo;t explain it step by step!</p>
<h2 id="getting-the-data">
  <a class="jumplink" href="#getting-the-data" aria-hidden="true">¶</a>
  Getting the data
</h2><p>This is the first, and sometimes hardest step. My advice is to be as explicit as is reasonable when requesting the data. It&rsquo;s helpful to be particular about what metadata you&rsquo;re after, and it&rsquo;ll help you if you request to receive it in a machine readable format.</p>
<p>In my case, I received an XLSX file. Not as ideal as a CSV or GeoJSON but also better than receiving a PDF!</p>
<p>You can see my original request and even get a copy of the data <a href="https://fyi.org.nz/request/11018-request-of-towing-data-for-three-tamaki-makaurau-police-districts#incoming-39588">here</a></p>
<h2 id="parsing-the-data">
  <a class="jumplink" href="#parsing-the-data" aria-hidden="true">¶</a>
  Parsing the data
</h2><p>First, we need to see what we&rsquo;ve actually got to work with and then we can parse it into a nicer format.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&gt; ls
</span></span><span style="display:flex;"><span>Marcus Aug <span style="color:#bd93f9">2016</span> Jul 2019.xlsx
</span></span><span style="display:flex;"><span>&gt; mv Marcus<span style="color:#f1fa8c">\ </span>Aug<span style="color:#f1fa8c">\ </span>2016<span style="color:#f1fa8c">\ </span>Jul<span style="color:#f1fa8c">\ </span>2019.xlsx towing.xlsx
</span></span><span style="display:flex;"><span>&gt; head -n <span style="color:#bd93f9">1</span> towing.xlsx 
</span></span><span style="display:flex;"><span>P!??@?6??<span style="color:#ff79c6">[</span>Content_Types<span style="color:#ff79c6">]</span>.xml ??<span style="color:#ff79c6">(</span>??YMo?@?W???Z?eM?&amp;?C??m??R??+??YR??<span style="color:#ff79c6">]</span>/?Q<span style="color:#f1fa8c">&#34;?)s?w?{??ߌ???F7?xT?̘??,S?J?????1:gi*?X3?d????7[???g??}?????:0???z-C????r%????????0aZ
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">                                                                           6?~??\7!???_??*ò??u-ՌI?U???;S=!??B?P?r?#t?΃??ɝW??_10d? ????????</span>$<span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">                                                           k??C
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">                                                               ?????Q??????WdW҇?R??????_?Z??_?{4?r-????Z?&lt;?}&lt;??6??SǤ?&#34;</span>DP2&amp;<span style="color:#f1fa8c">&#34;???&#34;</span>䜊??T??B榙9?	c?D?D????Cub??kx?<span style="color:#ff79c6">}</span>??b?6pr	s?<span style="color:#ff79c6">}</span>%??:?/?®?7;*vYPq???;P?1&lt;5??tI?3Y???J?G?????Q132B??d??L??b?ST<span style="color:#f1fa8c">\?</span>???.v????@<span style="color:#f1fa8c">&#34;???????P!^?e??jT??=|P??u?G;?8??O?dv
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">                         ?_rels/.rels ??(????N?0
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">                                                ??H?C???n ???]&amp;??*`????Q?A??</span><span style="color:#8be9fd;font-style:italic">$?</span><span style="color:#f1fa8c">F??؟???)??8??|h?*??r)?j6???|)W?R???`ϖ?&lt;Q????j?L=?4???\lP???=?Ѐ!cG6u*????58???&lt;???COq0J?????&lt;??yٛ??մg}??3+??H֐Y9??|l?5?D_STҰ~J??\??%?&#39;?\N???0PD?A??y?O???r?刦??t???w???????c?&lt;,???F?ɷ,&gt;??P!ωkE%??xl/_rels/workbook.xml.rels ??(??XMo?0?#?&#34;</span>߉?3?E????z?<span style="color:#f1fa8c">&#34;q??&amp;??C?
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">          ??Z??
</span></span></span></code></pre></div><p>Well, that&rsquo;s not going to work! We need to use some tools that can actually parse this data. For that, I&rsquo;m going to use <a href="https://pandas.pydata.org/">Pandas</a>, a data analysis library for Python.</p>
<p>This blog post isn&rsquo;t intended to teach you how to use Pandas, but I&rsquo;ll be specific enough that you should be able to follow along with the provided dataset yourself.</p>
<p>Pandas has support for importing Excel spreadsheets by using the <a href="https://xlrd.readthedocs.io/en/latest/">xlrd</a> library so let&rsquo;s install both. We&rsquo;ll also fetch sqlite3 which we&rsquo;ll use near the end:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&gt; pip install pandas xlrd sqlite3
</span></span><span style="display:flex;"><span>Collecting pandas
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">[</span>...<span style="color:#ff79c6">]</span>
</span></span><span style="display:flex;"><span>Installing collected packages: numpy, pandas, xlrd
</span></span><span style="display:flex;"><span>Successfully installed numpy-1.18.1 pandas-0.25.3 xlrd-1.2.0
</span></span></code></pre></div><p>Time to import our Excel spreadsheet into a Pandas dataframe but there&rsquo;s a bit of a catch first:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff79c6">&gt;</span> python
</span></span><span style="display:flex;"><span>Python <span style="color:#bd93f9">3.8.0</span> (default, Dec  <span style="color:#bd93f9">1</span> <span style="color:#bd93f9">2019</span>, <span style="color:#bd93f9">12</span>:<span style="color:#bd93f9">43</span>:<span style="color:#bd93f9">25</span>) 
</span></span><span style="display:flex;"><span>[Clang <span style="color:#bd93f9">10.0.1</span> (clang<span style="color:#ff79c6">-</span><span style="color:#bd93f9">1001.0.46.4</span>)] on darwin
</span></span><span style="display:flex;"><span>Type <span style="color:#f1fa8c">&#34;help&#34;</span>, <span style="color:#f1fa8c">&#34;copyright&#34;</span>, <span style="color:#f1fa8c">&#34;credits&#34;</span> <span style="color:#ff79c6">or</span> <span style="color:#f1fa8c">&#34;license&#34;</span> <span style="color:#ff79c6">for</span> more information<span style="color:#ff79c6">.</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&gt;&gt;&gt;</span> <span style="color:#ff79c6">import</span> pandas <span style="color:#ff79c6">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&gt;&gt;&gt;</span> workbook <span style="color:#ff79c6">=</span> pd<span style="color:#ff79c6">.</span>ExcelFile(<span style="color:#f1fa8c">&#39;~/Downloads/towing.xlsx&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&gt;&gt;&gt;</span> workbook<span style="color:#ff79c6">.</span>sheet_names
</span></span><span style="display:flex;"><span>[<span style="color:#f1fa8c">&#39;Aug 16&#39;</span>, <span style="color:#f1fa8c">&#39;Sep 16&#39;</span>, <span style="color:#f1fa8c">&#39;Oct 16&#39;</span>, <span style="color:#f1fa8c">&#39;Nov 16&#39;</span>, <span style="color:#f1fa8c">&#39;Dec 16&#39;</span>, <span style="color:#f1fa8c">&#39;Jan 17&#39;</span>, <span style="color:#f1fa8c">&#39;Feb 17&#39;</span>, <span style="color:#f1fa8c">&#39;Mar 17&#39;</span>, <span style="color:#f1fa8c">&#39;Apr 17&#39;</span>, <span style="color:#f1fa8c">&#39;May 17&#39;</span>, <span style="color:#f1fa8c">&#39;Jun 17&#39;</span>, <span style="color:#f1fa8c">&#39;Jul 17&#39;</span>, <span style="color:#f1fa8c">&#39;Aug 17&#39;</span>, <span style="color:#f1fa8c">&#39;Sep 17&#39;</span>, <span style="color:#f1fa8c">&#39;Oct 17&#39;</span>, <span style="color:#f1fa8c">&#39;Nov 17&#39;</span>, <span style="color:#f1fa8c">&#39;Dec 17&#39;</span>, <span style="color:#f1fa8c">&#39;Jan 18&#39;</span>, <span style="color:#f1fa8c">&#39;Feb 18&#39;</span>, <span style="color:#f1fa8c">&#39;Mar 18&#39;</span>, <span style="color:#f1fa8c">&#39;Apr 18&#39;</span>, <span style="color:#f1fa8c">&#39;May 18&#39;</span>, <span style="color:#f1fa8c">&#39;Jun 18&#39;</span>, <span style="color:#f1fa8c">&#39;Jul 18&#39;</span>, <span style="color:#f1fa8c">&#39;Aug 18&#39;</span>, <span style="color:#f1fa8c">&#39;Sep 18&#39;</span>, <span style="color:#f1fa8c">&#39;Oct 18&#39;</span>, <span style="color:#f1fa8c">&#39;Nov 18&#39;</span>, <span style="color:#f1fa8c">&#39;Dec 18&#39;</span>, <span style="color:#f1fa8c">&#39;Jan 19&#39;</span>, <span style="color:#f1fa8c">&#39;Feb 19&#39;</span>, <span style="color:#f1fa8c">&#39;Mar 19&#39;</span>, <span style="color:#f1fa8c">&#39;Apr 19&#39;</span>, <span style="color:#f1fa8c">&#39;May 19&#39;</span>, <span style="color:#f1fa8c">&#39;Jun 19&#39;</span>, <span style="color:#f1fa8c">&#39;Jul 19&#39;</span>]
</span></span></code></pre></div><p>Our workbook is not one big sheet but in fact, one sheet per month. For those of you who don&rsquo;t use Excel (ie me), sheets are those tabs at the bottom of the application. Usually you&rsquo;ll just see &ldquo;Sheet 1&rdquo; when viewing a blank spreadsheet.</p>
<p>We still need to parse each sheet, one by one, in order to get a complete collection of data. To do so, we&rsquo;ll just iterate over each sheet and append it to an initially empty data frame:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff79c6">&gt;</span> python
</span></span><span style="display:flex;"><span>Python <span style="color:#bd93f9">3.8.0</span> (default, Dec  <span style="color:#bd93f9">1</span> <span style="color:#bd93f9">2019</span>, <span style="color:#bd93f9">12</span>:<span style="color:#bd93f9">43</span>:<span style="color:#bd93f9">25</span>) 
</span></span><span style="display:flex;"><span>[Clang <span style="color:#bd93f9">10.0.1</span> (clang<span style="color:#ff79c6">-</span><span style="color:#bd93f9">1001.0.46.4</span>)] on darwin
</span></span><span style="display:flex;"><span>Type <span style="color:#f1fa8c">&#34;help&#34;</span>, <span style="color:#f1fa8c">&#34;copyright&#34;</span>, <span style="color:#f1fa8c">&#34;credits&#34;</span> <span style="color:#ff79c6">or</span> <span style="color:#f1fa8c">&#34;license&#34;</span> <span style="color:#ff79c6">for</span> more information<span style="color:#ff79c6">.</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&gt;&gt;&gt;</span> <span style="color:#ff79c6">import</span> pandas <span style="color:#ff79c6">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&gt;&gt;&gt;</span> workbook <span style="color:#ff79c6">=</span> pd<span style="color:#ff79c6">.</span>ExcelFile(<span style="color:#f1fa8c">&#34;~/Downloads/towing.xlsx&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&gt;&gt;&gt;</span> df <span style="color:#ff79c6">=</span> pd<span style="color:#ff79c6">.</span>DataFrame()
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&gt;&gt;&gt;</span> <span style="color:#ff79c6">for</span> sheet_name <span style="color:#ff79c6">in</span> workbook<span style="color:#ff79c6">.</span>sheet_names:
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">...</span>     sheet <span style="color:#ff79c6">=</span> workbook<span style="color:#ff79c6">.</span>parse(sheet_name<span style="color:#ff79c6">=</span>sheet_name)
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">...</span>     df <span style="color:#ff79c6">=</span> df<span style="color:#ff79c6">.</span>append(sheet, sort<span style="color:#ff79c6">=</span><span style="color:#ff79c6">False</span>)
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">...</span> 
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&gt;&gt;&gt;</span> df
</span></span><span style="display:flex;"><span>     Unnamed: <span style="color:#bd93f9">0</span>        Date <span style="color:#ff79c6">and</span> Time   <span style="color:#ff79c6">...</span> Unnamed: <span style="color:#bd93f9">9</span> Unnamed: <span style="color:#bd93f9">10</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">0</span>           NaN                   NaN  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1</span>           NaN   Monday, <span style="color:#bd93f9">01</span> Aug <span style="color:#bd93f9">2016</span>  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2</span>           NaN                   NaN  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">3</span>           NaN            <span style="color:#bd93f9">08</span>:<span style="color:#bd93f9">34</span> a<span style="color:#ff79c6">.</span>m<span style="color:#ff79c6">.</span>  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">4</span>           NaN            <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">06</span> a<span style="color:#ff79c6">.</span>m<span style="color:#ff79c6">.</span>  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">...</span>         <span style="color:#ff79c6">...</span>                   <span style="color:#ff79c6">...</span>  <span style="color:#ff79c6">...</span>        <span style="color:#ff79c6">...</span>         <span style="color:#ff79c6">...</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1754</span>        NaN                   NaN  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1755</span>        NaN  Tuesday, <span style="color:#bd93f9">23</span> Jul <span style="color:#bd93f9">2019</span>  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1756</span>        NaN                   NaN  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1757</span>        NaN            <span style="color:#bd93f9">09</span>:<span style="color:#bd93f9">05</span> p<span style="color:#ff79c6">.</span>m<span style="color:#ff79c6">.</span>  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1758</span>        NaN                   NaN  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#bd93f9">64160</span> rows x <span style="color:#bd93f9">11</span> columns]
</span></span></code></pre></div><p>There we go, all 64,000 rows in one nice data frame we can reason about!</p>
<p>We&rsquo;ve still got a long way to go however as we don&rsquo;t have a nice index, nor do we even have anywhere remotely consistent data.</p>
<h2 id="cleaning-up-the-data">
  <a class="jumplink" href="#cleaning-up-the-data" aria-hidden="true">¶</a>
  Cleaning up the data
</h2><p>First, let&rsquo;s have a closer look at our data by printing the first 25 rows:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff79c6">&gt;&gt;&gt;</span> df[<span style="color:#bd93f9">0</span>:<span style="color:#bd93f9">25</span>]
</span></span><span style="display:flex;"><span>   Unnamed: <span style="color:#bd93f9">0</span>        Date <span style="color:#ff79c6">and</span> Time   <span style="color:#ff79c6">...</span> Unnamed: <span style="color:#bd93f9">9</span> Unnamed: <span style="color:#bd93f9">10</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">0</span>         NaN                   NaN  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1</span>         NaN   Monday, <span style="color:#bd93f9">01</span> Aug <span style="color:#bd93f9">2016</span>  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2</span>         NaN                   NaN  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">3</span>         NaN            <span style="color:#bd93f9">08</span>:<span style="color:#bd93f9">34</span> a<span style="color:#ff79c6">.</span>m<span style="color:#ff79c6">.</span>  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">4</span>         NaN            <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">06</span> a<span style="color:#ff79c6">.</span>m<span style="color:#ff79c6">.</span>  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">5</span>         NaN            <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">42</span> a<span style="color:#ff79c6">.</span>m<span style="color:#ff79c6">.</span>  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">6</span>         NaN            <span style="color:#bd93f9">11</span>:<span style="color:#bd93f9">49</span> a<span style="color:#ff79c6">.</span>m<span style="color:#ff79c6">.</span>  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">7</span>         NaN            <span style="color:#bd93f9">01</span>:<span style="color:#bd93f9">18</span> p<span style="color:#ff79c6">.</span>m<span style="color:#ff79c6">.</span>  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">8</span>         NaN            <span style="color:#bd93f9">04</span>:<span style="color:#bd93f9">09</span> p<span style="color:#ff79c6">.</span>m<span style="color:#ff79c6">.</span>  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">9</span>         NaN            <span style="color:#bd93f9">04</span>:<span style="color:#bd93f9">10</span> p<span style="color:#ff79c6">.</span>m<span style="color:#ff79c6">.</span>  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">10</span>        NaN            <span style="color:#bd93f9">04</span>:<span style="color:#bd93f9">17</span> p<span style="color:#ff79c6">.</span>m<span style="color:#ff79c6">.</span>  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">11</span>        NaN            <span style="color:#bd93f9">04</span>:<span style="color:#bd93f9">21</span> p<span style="color:#ff79c6">.</span>m<span style="color:#ff79c6">.</span>  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">12</span>        NaN            <span style="color:#bd93f9">04</span>:<span style="color:#bd93f9">31</span> p<span style="color:#ff79c6">.</span>m<span style="color:#ff79c6">.</span>  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">13</span>        NaN            <span style="color:#bd93f9">04</span>:<span style="color:#bd93f9">40</span> p<span style="color:#ff79c6">.</span>m<span style="color:#ff79c6">.</span>  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">14</span>        NaN            <span style="color:#bd93f9">04</span>:<span style="color:#bd93f9">44</span> p<span style="color:#ff79c6">.</span>m<span style="color:#ff79c6">.</span>  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">15</span>        NaN            <span style="color:#bd93f9">04</span>:<span style="color:#bd93f9">57</span> p<span style="color:#ff79c6">.</span>m<span style="color:#ff79c6">.</span>  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">16</span>        NaN            <span style="color:#bd93f9">08</span>:<span style="color:#bd93f9">17</span> p<span style="color:#ff79c6">.</span>m<span style="color:#ff79c6">.</span>  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">17</span>        NaN                   NaN  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">18</span>        NaN  Tuesday, <span style="color:#bd93f9">02</span> Aug <span style="color:#bd93f9">2016</span>  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">19</span>        NaN                   NaN  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">20</span>        NaN            <span style="color:#bd93f9">02</span>:<span style="color:#bd93f9">04</span> a<span style="color:#ff79c6">.</span>m<span style="color:#ff79c6">.</span>  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">21</span>        NaN            <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">50</span> a<span style="color:#ff79c6">.</span>m<span style="color:#ff79c6">.</span>  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">22</span>        NaN            <span style="color:#bd93f9">11</span>:<span style="color:#bd93f9">41</span> a<span style="color:#ff79c6">.</span>m<span style="color:#ff79c6">.</span>  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">23</span>        NaN            <span style="color:#bd93f9">02</span>:<span style="color:#bd93f9">32</span> p<span style="color:#ff79c6">.</span>m<span style="color:#ff79c6">.</span>  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">24</span>        NaN            <span style="color:#bd93f9">04</span>:<span style="color:#bd93f9">13</span> p<span style="color:#ff79c6">.</span>m<span style="color:#ff79c6">.</span>  <span style="color:#ff79c6">...</span>        NaN         NaN
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#bd93f9">25</span> rows x <span style="color:#bd93f9">11</span> columns]
</span></span></code></pre></div><p>Focusing on the date column, there&rsquo;s a pattern that sticks out. The data is actually grouped visually by day like so:</p>
<pre tabindex="0"><code>[empty cell]
Monday, 01 Aug 2016
[empty cell]
08:34 a.m.
[...]
08:17 p.m.
[empty cell]
Tuesday, 02 Aug 2016
[empty cell]
02:04 a.m.
</code></pre><p>There&rsquo;s no consistency from a machine readable point of view so we&rsquo;ll have to clean it up into something more consistent manually. Before we do that, let&rsquo;s get some column headings.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff79c6">&gt;</span> <span style="color:#ff79c6">from</span> pprint <span style="color:#ff79c6">import</span> pprint
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&gt;</span> pprint(<span style="color:#8be9fd;font-style:italic">list</span>(df<span style="color:#ff79c6">.</span>columns))
</span></span><span style="display:flex;"><span>[<span style="color:#f1fa8c">&#39;Unnamed: 0&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#f1fa8c">&#39;Date and Time &#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#f1fa8c">&#39;Vehicle &#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#f1fa8c">&#39;Towed From &#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#f1fa8c">&#39;Towed Too &#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#f1fa8c">&#39;Unnamed: 5&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#f1fa8c">&#39;Unnamed: 6&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#f1fa8c">&#39;Unnamed: 7&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#f1fa8c">&#39;Unnamed: 8&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#f1fa8c">&#39;Unnamed: 9&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#f1fa8c">&#39;Unnamed: 10&#39;</span>]
</span></span></code></pre></div><p>That&rsquo;s a lot of columns.</p>
<p>After a quick skim of the dataset, we can see that only <code>Unnamed: 5</code> is used. We&rsquo;ll discard the unused columns and then clean up the remaining data:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff79c6">&gt;</span> df <span style="color:#ff79c6">=</span> df<span style="color:#ff79c6">.</span>drop(columns<span style="color:#ff79c6">=</span>[<span style="color:#f1fa8c">&#39;Unnamed: 0&#39;</span>, <span style="color:#f1fa8c">&#39;Unnamed: 6&#39;</span>, <span style="color:#f1fa8c">&#39;Unnamed: 7&#39;</span>, <span style="color:#f1fa8c">&#39;Unnamed: 8&#39;</span>, <span style="color:#f1fa8c">&#39;Unnamed: 9&#39;</span>, <span style="color:#f1fa8c">&#39;Unnamed: 10&#39;</span>])
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&gt;&gt;&gt;</span> df
</span></span><span style="display:flex;"><span>            Date <span style="color:#ff79c6">and</span> Time          Vehicle   <span style="color:#ff79c6">...</span>       Towed Too  Unnamed: <span style="color:#bd93f9">5</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">0</span>                      NaN              NaN  <span style="color:#ff79c6">...</span>              NaN        NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1</span>      Monday, <span style="color:#bd93f9">01</span> Aug <span style="color:#bd93f9">2016</span>              NaN  <span style="color:#ff79c6">...</span>              NaN         <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2</span>                      NaN              NaN  <span style="color:#ff79c6">...</span>              NaN         <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">3</span>               <span style="color:#bd93f9">08</span>:<span style="color:#bd93f9">34</span> a<span style="color:#ff79c6">.</span>m<span style="color:#ff79c6">.</span>  TOYOTA FUNCARGO  <span style="color:#ff79c6">...</span>   <span style="color:#bd93f9">2</span> PUKEHANA AVE         <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">4</span>               <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">06</span> a<span style="color:#ff79c6">.</span>m<span style="color:#ff79c6">.</span>          AUDI A3  <span style="color:#ff79c6">...</span>  <span style="color:#bd93f9">30</span>A CROMWELL ST         <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">...</span>                    <span style="color:#ff79c6">...</span>              <span style="color:#ff79c6">...</span>  <span style="color:#ff79c6">...</span>              <span style="color:#ff79c6">...</span>        <span style="color:#ff79c6">...</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1754</span>                   NaN              NaN  <span style="color:#ff79c6">...</span>       Total    <span style="color:#bd93f9">1</span>      Romeo
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1755</span>  Tuesday, <span style="color:#bd93f9">23</span> Jul <span style="color:#bd93f9">2019</span>              NaN  <span style="color:#ff79c6">...</span>              NaN      Romeo
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1756</span>                   NaN              NaN  <span style="color:#ff79c6">...</span>              NaN      Romeo
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1757</span>            <span style="color:#bd93f9">09</span>:<span style="color:#bd93f9">05</span> p<span style="color:#ff79c6">.</span>m<span style="color:#ff79c6">.</span>   TOYOTA, ESTIMA  <span style="color:#ff79c6">...</span>     <span style="color:#bd93f9">7</span> FLAVELL DR      Romeo
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1758</span>                   NaN              NaN  <span style="color:#ff79c6">...</span>       Total    <span style="color:#bd93f9">1</span>      Romeo
</span></span></code></pre></div><p>It&rsquo;s starting to look more reasonable. Now let&rsquo;s assign some appropriate names. You can&rsquo;t quite tell from the code snippets but there&rsquo;s actually some rogue whitespace in the columns so I opened to rename all of them for consistency:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff79c6">&gt;</span> df <span style="color:#ff79c6">=</span> df<span style="color:#ff79c6">.</span>rename(columns<span style="color:#ff79c6">=</span>{<span style="color:#f1fa8c">&#39;Unnamed: 5&#39;</span>: <span style="color:#f1fa8c">&#39;Suburb&#39;</span>, <span style="color:#f1fa8c">&#39;Date and Time &#39;</span>: <span style="color:#f1fa8c">&#39;Date&#39;</span>, <span style="color:#f1fa8c">&#39;Towed From &#39;</span>: <span style="color:#f1fa8c">&#39;Origin&#39;</span>, <span style="color:#f1fa8c">&#39;Towed Too &#39;</span>: <span style="color:#f1fa8c">&#39;Destination&#39;</span>, <span style="color:#f1fa8c">&#39;Vehicle &#39;</span>: <span style="color:#f1fa8c">&#39;Vehicle&#39;</span>})
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&gt;&gt;&gt;</span> df
</span></span><span style="display:flex;"><span>                      Date          Vehicle  <span style="color:#ff79c6">...</span>      Destination Suburb
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">0</span>                      NaN              NaN  <span style="color:#ff79c6">...</span>              NaN    NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1</span>      Monday, <span style="color:#bd93f9">01</span> Aug <span style="color:#bd93f9">2016</span>              NaN  <span style="color:#ff79c6">...</span>              NaN     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2</span>                      NaN              NaN  <span style="color:#ff79c6">...</span>              NaN     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">3</span>               <span style="color:#bd93f9">08</span>:<span style="color:#bd93f9">34</span> a<span style="color:#ff79c6">.</span>m<span style="color:#ff79c6">.</span>  TOYOTA FUNCARGO  <span style="color:#ff79c6">...</span>   <span style="color:#bd93f9">2</span> PUKEHANA AVE     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">4</span>               <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">06</span> a<span style="color:#ff79c6">.</span>m<span style="color:#ff79c6">.</span>          AUDI A3  <span style="color:#ff79c6">...</span>  <span style="color:#bd93f9">30</span>A CROMWELL ST     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">...</span>                    <span style="color:#ff79c6">...</span>              <span style="color:#ff79c6">...</span>  <span style="color:#ff79c6">...</span>              <span style="color:#ff79c6">...</span>    <span style="color:#ff79c6">...</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1754</span>                   NaN              NaN  <span style="color:#ff79c6">...</span>       Total    <span style="color:#bd93f9">1</span>  Romeo
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1755</span>  Tuesday, <span style="color:#bd93f9">23</span> Jul <span style="color:#bd93f9">2019</span>              NaN  <span style="color:#ff79c6">...</span>              NaN  Romeo
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1756</span>                   NaN              NaN  <span style="color:#ff79c6">...</span>              NaN  Romeo
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1757</span>            <span style="color:#bd93f9">09</span>:<span style="color:#bd93f9">05</span> p<span style="color:#ff79c6">.</span>m<span style="color:#ff79c6">.</span>   TOYOTA, ESTIMA  <span style="color:#ff79c6">...</span>     <span style="color:#bd93f9">7</span> FLAVELL DR  Romeo
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1758</span>                   NaN              NaN  <span style="color:#ff79c6">...</span>       Total    <span style="color:#bd93f9">1</span>  Romeo
</span></span></code></pre></div><p>Even better! We&rsquo;re almost in a position to start parsing our dates into valid timestamps.</p>
<h2 id="performing-some-data-fixes">
  <a class="jumplink" href="#performing-some-data-fixes" aria-hidden="true">¶</a>
  Performing some data fixes
</h2><p>Here&rsquo;s the part that was the most difficult, which I&rsquo;ve already done for you thankfully.</p>
<p>Basically, I wrote some code to parse the dates into timestamps and it would keep breaking. I&rsquo;d fix the offending piece of data, run it again and see where it broke next. I&rsquo;d keep doing that until the script ran to completion.</p>
<p>Here are the following data fixes, provided so you can follow along entirely with my process:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df <span style="color:#ff79c6">=</span> df<span style="color:#ff79c6">.</span>replace(<span style="color:#f1fa8c">&#39;Sunda, 28 Aug 2016&#39;</span>, <span style="color:#f1fa8c">&#39;Sunday, 28 Aug 2016&#39;</span>)
</span></span><span style="display:flex;"><span>df <span style="color:#ff79c6">=</span> df<span style="color:#ff79c6">.</span>replace(<span style="color:#f1fa8c">&#39;Satruday, 06 Jan 2017&#39;</span>, <span style="color:#f1fa8c">&#39;Saturday, 06 Jan 2017&#39;</span>)
</span></span><span style="display:flex;"><span>df <span style="color:#ff79c6">=</span> df<span style="color:#ff79c6">.</span>replace(<span style="color:#f1fa8c">&#39;Tuesday, 28th Nov &#39;</span>, <span style="color:#f1fa8c">&#39;Tuesday, 28 Nov 2017&#39;</span>)
</span></span><span style="display:flex;"><span>df <span style="color:#ff79c6">=</span> df<span style="color:#ff79c6">.</span>replace(<span style="color:#f1fa8c">&#39;4.40pm&#39;</span>, <span style="color:#f1fa8c">&#39;4:40pm&#39;</span>)
</span></span><span style="display:flex;"><span>df <span style="color:#ff79c6">=</span> df<span style="color:#ff79c6">.</span>replace(<span style="color:#f1fa8c">&#39;5.08pm&#39;</span>, <span style="color:#f1fa8c">&#39;5:08pm&#39;</span>)
</span></span><span style="display:flex;"><span>df <span style="color:#ff79c6">=</span> df<span style="color:#ff79c6">.</span>replace(<span style="color:#f1fa8c">&#39;14:55 pm&#39;</span>, <span style="color:#f1fa8c">&#39;2:55pm&#39;</span>)
</span></span><span style="display:flex;"><span>df <span style="color:#ff79c6">=</span> df<span style="color:#ff79c6">.</span>replace(<span style="color:#f1fa8c">&#39;4.37 p.m.&#39;</span>, <span style="color:#f1fa8c">&#39;4:37pm&#39;</span>)
</span></span><span style="display:flex;"><span>df <span style="color:#ff79c6">=</span> df<span style="color:#ff79c6">.</span>replace(<span style="color:#f1fa8c">&#39;17:01 p.m&#39;</span>, <span style="color:#f1fa8c">&#39;5:01pm&#39;</span>)
</span></span><span style="display:flex;"><span>df <span style="color:#ff79c6">=</span> df<span style="color:#ff79c6">.</span>replace(<span style="color:#f1fa8c">&#39;4.22 p.m.&#39;</span>, <span style="color:#f1fa8c">&#39;4:22pm&#39;</span>)
</span></span><span style="display:flex;"><span>df <span style="color:#ff79c6">=</span> df<span style="color:#ff79c6">.</span>replace(<span style="color:#f1fa8c">&#39;4.32 p.m.&#39;</span>, <span style="color:#f1fa8c">&#39;4:32pm&#39;</span>)
</span></span></code></pre></div><h2 id="transforming-dates-into-valid-timestamps">
  <a class="jumplink" href="#transforming-dates-into-valid-timestamps" aria-hidden="true">¶</a>
  Transforming dates into valid timestamps
</h2><p>Now that our data is in much better shape, we can tackle arguably the part that really got me thinking. It wasn&rsquo;t difficult in a blood, sweat and tears kind of way but was definitely a stretch.</p>
<p>Before I walk you through what I settled for, I&rsquo;ll caveat that there may be more ideal ways of doing this. What I wrote got the job done and that&rsquo;s all I cared about ;)</p>
<p>Since our date column includes pseudo-headings, I realised I can just pass over the whole column once.</p>
<p>If the word <code>day</code> is in a column (as it would be in every heading), we can use that cell to determine the date we&rsquo;ve gotten up to. Any time below that cell implicitly refers to that date so we can merge it into the following cells.</p>
<p>Here&rsquo;s a visual example of what I mean:</p>
<table>
<thead>
<tr>
<th>Before</th>
<th>After</th>
</tr>
</thead>
<tbody>
<tr>
<td>Monday, 01 Aug 2016</td>
<td>Monday, 01 Aug 2016</td>
</tr>
<tr>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<td>8:34 a.m.</td>
<td>Monday, 01 Aug 2016 8:34 a.m.</td>
</tr>
<tr>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<td>Tuesday, 23 Jul 2019</td>
<td>Tuesday, 23 Jul 2019</td>
</tr>
<tr>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<td>4:00 a.m.</td>
<td>Tuesday, 23 Jul 2019 4:00 a.m.</td>
</tr>
<tr>
<td>9:42 p.m.</td>
<td>Tuesday 23 Jul 2019 9:42 p.m.</td>
</tr>
</tbody>
</table>
<p>The goal here isn&rsquo;t to get super accurate timestamps just yet, but rather something good enough that is consistent and therefore parsable. The rest of the mess, such as those <code>NaN</code> are trivial to get rid of later.</p>
<p>Anyway, here&rsquo;s the shortest possible version of the code required that I came up with:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff79c6">&gt;&gt;&gt;</span> current_date <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&gt;&gt;&gt;</span> <span style="color:#ff79c6">for</span> idx, entry <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">enumerate</span>(df[<span style="color:#f1fa8c">&#39;Date&#39;</span>]):
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">...</span>     item <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">str</span>(entry)
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">...</span>     <span style="color:#ff79c6">if</span> <span style="color:#f1fa8c">&#39;day&#39;</span> <span style="color:#ff79c6">in</span> item:
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">...</span>             current_date <span style="color:#ff79c6">=</span> item
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">...</span>     <span style="color:#ff79c6">if</span> <span style="color:#f1fa8c">&#39;day&#39;</span> <span style="color:#ff79c6">not</span> <span style="color:#ff79c6">in</span> item <span style="color:#ff79c6">and</span> item <span style="color:#ff79c6">!=</span> <span style="color:#f1fa8c">&#39;nan&#39;</span>:
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">...</span>             df<span style="color:#ff79c6">.</span>iloc[idx][<span style="color:#f1fa8c">&#39;Date&#39;</span>] <span style="color:#ff79c6">=</span> pd<span style="color:#ff79c6">.</span>to_datetime(<span style="color:#f1fa8c">f</span><span style="color:#f1fa8c">&#39;</span><span style="color:#f1fa8c">{</span>current_date<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c"> </span><span style="color:#f1fa8c">{</span>item<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">...</span>
</span></span></code></pre></div><p>It&rsquo;ll take a little bit to run, as it has to iterate over every row but it leaves us with something pretty promising:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff79c6">&gt;&gt;&gt;</span> df
</span></span><span style="display:flex;"><span>                      Date          Vehicle  <span style="color:#ff79c6">...</span>      Destination Suburb
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">0</span>                      NaN              NaN  <span style="color:#ff79c6">...</span>              NaN    NaN
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1</span>      Monday, <span style="color:#bd93f9">01</span> Aug <span style="color:#bd93f9">2016</span>              NaN  <span style="color:#ff79c6">...</span>              NaN     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2</span>                      NaN              NaN  <span style="color:#ff79c6">...</span>              NaN     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">3</span>      <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">01</span> <span style="color:#bd93f9">08</span>:<span style="color:#bd93f9">34</span>:<span style="color:#bd93f9">00</span>  TOYOTA FUNCARGO  <span style="color:#ff79c6">...</span>   <span style="color:#bd93f9">2</span> PUKEHANA AVE     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">4</span>      <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">01</span> <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">06</span>:<span style="color:#bd93f9">00</span>          AUDI A3  <span style="color:#ff79c6">...</span>  <span style="color:#bd93f9">30</span>A CROMWELL ST     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">...</span>                    <span style="color:#ff79c6">...</span>              <span style="color:#ff79c6">...</span>  <span style="color:#ff79c6">...</span>              <span style="color:#ff79c6">...</span>    <span style="color:#ff79c6">...</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1754</span>                   NaN              NaN  <span style="color:#ff79c6">...</span>       Total    <span style="color:#bd93f9">1</span>  Romeo
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1755</span>  Tuesday, <span style="color:#bd93f9">23</span> Jul <span style="color:#bd93f9">2019</span>              NaN  <span style="color:#ff79c6">...</span>              NaN  Romeo
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1756</span>                   NaN              NaN  <span style="color:#ff79c6">...</span>              NaN  Romeo
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1757</span>   <span style="color:#bd93f9">2019</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">07</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">23</span> <span style="color:#bd93f9">21</span>:<span style="color:#bd93f9">05</span>:<span style="color:#bd93f9">00</span>   TOYOTA, ESTIMA  <span style="color:#ff79c6">...</span>     <span style="color:#bd93f9">7</span> FLAVELL DR  Romeo
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1758</span>                   NaN              NaN  <span style="color:#ff79c6">...</span>       Total    <span style="color:#bd93f9">1</span>  Romeo
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#bd93f9">64160</span> rows x <span style="color:#bd93f9">5</span> columns]
</span></span></code></pre></div><p>Ok, I lied earlier. We use the <code>pd.to_datetime</code> function earlier to generate entirely valid timestamps. All that&rsquo;s left is to get rid of those intermediary cells and we should have some fresh data ready to operate on.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff79c6">&gt;&gt;&gt;</span> df <span style="color:#ff79c6">=</span> df<span style="color:#ff79c6">.</span>dropna()
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&gt;&gt;&gt;</span> df[<span style="color:#bd93f9">0</span>:<span style="color:#bd93f9">25</span>]
</span></span><span style="display:flex;"><span>                   Date            Vehicle  <span style="color:#ff79c6">...</span>      Destination Suburb
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">3</span>   <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">01</span> <span style="color:#bd93f9">08</span>:<span style="color:#bd93f9">34</span>:<span style="color:#bd93f9">00</span>    TOYOTA FUNCARGO  <span style="color:#ff79c6">...</span>   <span style="color:#bd93f9">2</span> PUKEHANA AVE     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">4</span>   <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">01</span> <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">06</span>:<span style="color:#bd93f9">00</span>            AUDI A3  <span style="color:#ff79c6">...</span>  <span style="color:#bd93f9">30</span>A CROMWELL ST     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">5</span>   <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">01</span> <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">42</span>:<span style="color:#bd93f9">00</span>        MAZDA DEMIO  <span style="color:#ff79c6">...</span>   <span style="color:#bd93f9">230</span> SYMONDS ST     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">6</span>   <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">01</span> <span style="color:#bd93f9">11</span>:<span style="color:#bd93f9">49</span>:<span style="color:#bd93f9">00</span>    TOYOTA VANGUARD  <span style="color:#ff79c6">...</span>   <span style="color:#bd93f9">230</span> SYMONDS ST     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">7</span>   <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">01</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">18</span>:<span style="color:#bd93f9">00</span>        TOYOTA VITZ  <span style="color:#ff79c6">...</span>   <span style="color:#bd93f9">230</span> SYMONDS ST     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">8</span>   <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">01</span> <span style="color:#bd93f9">16</span>:<span style="color:#bd93f9">09</span>:<span style="color:#bd93f9">00</span>  NISSAN PATHFINDER  <span style="color:#ff79c6">...</span>   <span style="color:#bd93f9">230</span> SYMONDS ST     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">9</span>   <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">01</span> <span style="color:#bd93f9">16</span>:<span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">00</span>    VOLKSWAGEN GOLF  <span style="color:#ff79c6">...</span>   <span style="color:#bd93f9">230</span> SYMONDS ST     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">10</span>  <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">01</span> <span style="color:#bd93f9">16</span>:<span style="color:#bd93f9">17</span>:<span style="color:#bd93f9">00</span>       HONDA ACCORD  <span style="color:#ff79c6">...</span>   <span style="color:#bd93f9">230</span> SYMONDS ST     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">11</span>  <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">01</span> <span style="color:#bd93f9">16</span>:<span style="color:#bd93f9">21</span>:<span style="color:#bd93f9">00</span>  TOYOTA HIGHLANDER  <span style="color:#ff79c6">...</span>   <span style="color:#bd93f9">230</span> SYMONDS ST     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">12</span>  <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">01</span> <span style="color:#bd93f9">16</span>:<span style="color:#bd93f9">31</span>:<span style="color:#bd93f9">00</span>        TOYOTA RAV4  <span style="color:#ff79c6">...</span>   <span style="color:#bd93f9">230</span> SYMONDS ST     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">13</span>  <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">01</span> <span style="color:#bd93f9">16</span>:<span style="color:#bd93f9">40</span>:<span style="color:#bd93f9">00</span>          HONDA FIT  <span style="color:#ff79c6">...</span>   <span style="color:#bd93f9">230</span> SYMONDS ST     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">14</span>  <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">01</span> <span style="color:#bd93f9">16</span>:<span style="color:#bd93f9">44</span>:<span style="color:#bd93f9">00</span>      TOYOTA CELICA  <span style="color:#ff79c6">...</span>   <span style="color:#bd93f9">230</span> SYMONDS ST     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">15</span>  <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">01</span> <span style="color:#bd93f9">16</span>:<span style="color:#bd93f9">57</span>:<span style="color:#bd93f9">00</span>   HOLDEN COMMODORE  <span style="color:#ff79c6">...</span>   <span style="color:#bd93f9">230</span> SYMONDS ST     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">16</span>  <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">01</span> <span style="color:#bd93f9">20</span>:<span style="color:#bd93f9">17</span>:<span style="color:#bd93f9">00</span>      TOYOTA TRUENO  <span style="color:#ff79c6">...</span>   <span style="color:#bd93f9">230</span> SYMONDS ST     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">20</span>  <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">02</span> <span style="color:#bd93f9">02</span>:<span style="color:#bd93f9">04</span>:<span style="color:#bd93f9">00</span>         HONDA JAZZ  <span style="color:#ff79c6">...</span>      <span style="color:#bd93f9">3</span> KORARI ST     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">21</span>  <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">02</span> <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">50</span>:<span style="color:#bd93f9">00</span>      TOYOTA CARINA  <span style="color:#ff79c6">...</span>       HENDON AVE     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">22</span>  <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">02</span> <span style="color:#bd93f9">11</span>:<span style="color:#bd93f9">41</span>:<span style="color:#bd93f9">00</span>        MAZDA DEMIO  <span style="color:#ff79c6">...</span>   <span style="color:#bd93f9">230</span> SYMONDS ST     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">23</span>  <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">02</span> <span style="color:#bd93f9">14</span>:<span style="color:#bd93f9">32</span>:<span style="color:#bd93f9">00</span>     TOYOTA COROLLA  <span style="color:#ff79c6">...</span>   <span style="color:#bd93f9">230</span> SYMONDS ST     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">24</span>  <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">02</span> <span style="color:#bd93f9">16</span>:<span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">00</span>      NISSAN PULSAR  <span style="color:#ff79c6">...</span>   <span style="color:#bd93f9">230</span> SYMONDS ST     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">25</span>  <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">02</span> <span style="color:#bd93f9">16</span>:<span style="color:#bd93f9">21</span>:<span style="color:#bd93f9">00</span>             BMW X3  <span style="color:#ff79c6">...</span>   <span style="color:#bd93f9">230</span> SYMONDS ST     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">26</span>  <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">02</span> <span style="color:#bd93f9">16</span>:<span style="color:#bd93f9">23</span>:<span style="color:#bd93f9">00</span>    VOLKSWAGEN GOLF  <span style="color:#ff79c6">...</span>   <span style="color:#bd93f9">230</span> SYMONDS ST     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">27</span>  <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">02</span> <span style="color:#bd93f9">16</span>:<span style="color:#bd93f9">23</span>:<span style="color:#bd93f9">00</span>         CITROEN C3  <span style="color:#ff79c6">...</span>   <span style="color:#bd93f9">230</span> SYMONDS ST     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">28</span>  <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">02</span> <span style="color:#bd93f9">16</span>:<span style="color:#bd93f9">40</span>:<span style="color:#bd93f9">00</span>      VMOTO SCOOTER  <span style="color:#ff79c6">...</span>   <span style="color:#bd93f9">230</span> SYMONDS ST     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">29</span>  <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">02</span> <span style="color:#bd93f9">16</span>:<span style="color:#bd93f9">57</span>:<span style="color:#bd93f9">00</span>       SUZUKI SWIFT  <span style="color:#ff79c6">...</span>   <span style="color:#bd93f9">230</span> SYMONDS ST     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">30</span>  <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">02</span> <span style="color:#bd93f9">18</span>:<span style="color:#bd93f9">54</span>:<span style="color:#bd93f9">00</span>      NISSAN NAVARA  <span style="color:#ff79c6">...</span>   <span style="color:#bd93f9">230</span> SYMONDS ST     <span style="color:#bd93f9">55</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#bd93f9">25</span> rows x <span style="color:#bd93f9">5</span> columns]
</span></span></code></pre></div><p>Looks good to me!</p>
<h3 id="final-cleanup">
  <a class="jumplink" href="#final-cleanup" aria-hidden="true">¶</a>
  Final cleanup
</h3><p>Oh, one last thing. You&rsquo;ll see all of those numbers under the suburb section that don&rsquo;t appear to mean anything. The correspondence that came with the dataset explains what those represent. Let&rsquo;s quickly convert them into something human readable.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>df[<span style="color:#f1fa8c">&#39;Suburb&#39;</span>] <span style="color:#ff79c6">=</span> df[<span style="color:#f1fa8c">&#39;Suburb&#39;</span>]<span style="color:#ff79c6">.</span>replace(<span style="color:#bd93f9">55</span>, <span style="color:#f1fa8c">&#39;CENTRAL&#39;</span>)
</span></span><span style="display:flex;"><span>df[<span style="color:#f1fa8c">&#39;Suburb&#39;</span>] <span style="color:#ff79c6">=</span> df[<span style="color:#f1fa8c">&#39;Suburb&#39;</span>]<span style="color:#ff79c6">.</span>replace(<span style="color:#bd93f9">66</span>, <span style="color:#f1fa8c">&#39;NORTHERN&#39;</span>)
</span></span><span style="display:flex;"><span>df[<span style="color:#f1fa8c">&#39;Suburb&#39;</span>] <span style="color:#ff79c6">=</span> df[<span style="color:#f1fa8c">&#39;Suburb&#39;</span>]<span style="color:#ff79c6">.</span>replace(<span style="color:#bd93f9">77</span>, <span style="color:#f1fa8c">&#39;WESTERN&#39;</span>)
</span></span><span style="display:flex;"><span>df[<span style="color:#f1fa8c">&#39;Suburb&#39;</span>] <span style="color:#ff79c6">=</span> df[<span style="color:#f1fa8c">&#39;Suburb&#39;</span>]<span style="color:#ff79c6">.</span>replace(<span style="color:#bd93f9">88</span>, <span style="color:#f1fa8c">&#39;SOUTHERN&#39;</span>)
</span></span><span style="display:flex;"><span>df[<span style="color:#f1fa8c">&#39;Suburb&#39;</span>] <span style="color:#ff79c6">=</span> df[<span style="color:#f1fa8c">&#39;Suburb&#39;</span>]<span style="color:#ff79c6">.</span>replace(<span style="color:#bd93f9">99</span>, <span style="color:#f1fa8c">&#39;CBD&#39;</span>)
</span></span><span style="display:flex;"><span>df[<span style="color:#f1fa8c">&#39;Suburb&#39;</span>] <span style="color:#ff79c6">=</span> df[<span style="color:#f1fa8c">&#39;Suburb&#39;</span>]<span style="color:#ff79c6">.</span>replace(<span style="color:#f1fa8c">&#39;Romeo&#39;</span>, <span style="color:#f1fa8c">&#39;RURAL&#39;</span>)
</span></span></code></pre></div><p>Here&rsquo;s the final result after all of our hard work beating the dataset into shape:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff79c6">&gt;&gt;&gt;</span> df
</span></span><span style="display:flex;"><span>                     Date           Vehicle  <span style="color:#ff79c6">...</span>            Destination   Suburb
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">3</span>     <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">01</span> <span style="color:#bd93f9">08</span>:<span style="color:#bd93f9">34</span>:<span style="color:#bd93f9">00</span>   TOYOTA FUNCARGO  <span style="color:#ff79c6">...</span>         <span style="color:#bd93f9">2</span> PUKEHANA AVE  CENTRAL
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">4</span>     <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">01</span> <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">06</span>:<span style="color:#bd93f9">00</span>           AUDI A3  <span style="color:#ff79c6">...</span>        <span style="color:#bd93f9">30</span>A CROMWELL ST  CENTRAL
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">5</span>     <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">01</span> <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">42</span>:<span style="color:#bd93f9">00</span>       MAZDA DEMIO  <span style="color:#ff79c6">...</span>         <span style="color:#bd93f9">230</span> SYMONDS ST  CENTRAL
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">6</span>     <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">01</span> <span style="color:#bd93f9">11</span>:<span style="color:#bd93f9">49</span>:<span style="color:#bd93f9">00</span>   TOYOTA VANGUARD  <span style="color:#ff79c6">...</span>         <span style="color:#bd93f9">230</span> SYMONDS ST  CENTRAL
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">7</span>     <span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">01</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">18</span>:<span style="color:#bd93f9">00</span>       TOYOTA VITZ  <span style="color:#ff79c6">...</span>         <span style="color:#bd93f9">230</span> SYMONDS ST  CENTRAL
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">...</span>                   <span style="color:#ff79c6">...</span>               <span style="color:#ff79c6">...</span>  <span style="color:#ff79c6">...</span>                    <span style="color:#ff79c6">...</span>      <span style="color:#ff79c6">...</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1744</span>  <span style="color:#bd93f9">2019</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">07</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">03</span> <span style="color:#bd93f9">12</span>:<span style="color:#bd93f9">57</span>:<span style="color:#bd93f9">00</span>  HOLDEN COMMODORE  <span style="color:#ff79c6">...</span>           <span style="color:#bd93f9">18</span> COWLEY PL    RURAL
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1745</span>  <span style="color:#bd93f9">2019</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">07</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">03</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">45</span>:<span style="color:#bd93f9">00</span>      SUZUKI SWIFT  <span style="color:#ff79c6">...</span>               ADAMS DR    RURAL
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1749</span>  <span style="color:#bd93f9">2019</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">07</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">12</span> <span style="color:#bd93f9">12</span>:<span style="color:#bd93f9">01</span>:<span style="color:#bd93f9">00</span>        FIAT PUNTO  <span style="color:#ff79c6">...</span>  <span style="color:#bd93f9">22</span> HENDERSON VALLEY R    RURAL
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1753</span>  <span style="color:#bd93f9">2019</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">07</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">21</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">00</span>:<span style="color:#bd93f9">00</span>         MAZDA MPV  <span style="color:#ff79c6">...</span>           <span style="color:#bd93f9">61</span> CROOKS RD    RURAL
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">1757</span>  <span style="color:#bd93f9">2019</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">07</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">23</span> <span style="color:#bd93f9">21</span>:<span style="color:#bd93f9">05</span>:<span style="color:#bd93f9">00</span>    TOYOTA, ESTIMA  <span style="color:#ff79c6">...</span>           <span style="color:#bd93f9">7</span> FLAVELL DR    RURAL
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#bd93f9">49174</span> rows x <span style="color:#bd93f9">5</span> columns]
</span></span></code></pre></div><p>While we&rsquo;re nowhere near done just yet, I think this is a good place to cap off this post as moving forward, the dataset will shift out of Pandas as we start to translate towing addresses into tangible GPS coordinates. Once we&rsquo;ve got coordinates, we can begin plotting this data on a map.</p>
<p>Personally, I learnt a lot about Pandas by going through this whole ordeal. At first, I thought no way could this data set possibly be cleaned up but with enough head banging, anything is possible!</p>
<h3 id="exporting-the-data">
  <a class="jumplink" href="#exporting-the-data" aria-hidden="true">¶</a>
  Exporting the data
</h3><p>Rather than just leave this data sitting in memory, let&rsquo;s export it into a <a href="https://www.sqlite.org/index.html">SQLite</a> database so we can play around with it a bit more.</p>
<p>You&rsquo;ll need the <code>sqlite3</code> python package installed which I recommended installing near the top of this post.</p>
<p>We also need to set an index or trying to export the dataset will fail. Not quite sure why but presumably it doesn&rsquo;t know what to do with the default index. I haven&rsquo;t looked into it but we&rsquo;ll just set our timestamps as the new index.</p>
<p>Given that a human is entering this data, I highly doubt any of our timestamps clash. That said, it&rsquo;s always a good idea to choose something truly guaranteed to be unique so consider yourself warned :)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff79c6">&gt;&gt;&gt;</span> df <span style="color:#ff79c6">=</span> df<span style="color:#ff79c6">.</span>set_index(<span style="color:#f1fa8c">&#39;Date&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&gt;&gt;&gt;</span> df
</span></span><span style="display:flex;"><span>                              Vehicle          Origin            Destination   Suburb
</span></span><span style="display:flex;"><span>Date                                                                                 
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">01</span> <span style="color:#bd93f9">08</span>:<span style="color:#bd93f9">34</span>:<span style="color:#bd93f9">00</span>   TOYOTA FUNCARGO       <span style="color:#bd93f9">33</span> PAH RD         <span style="color:#bd93f9">2</span> PUKEHANA AVE  CENTRAL
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">01</span> <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">06</span>:<span style="color:#bd93f9">00</span>           AUDI A3  <span style="color:#bd93f9">30</span> CROMWELL ST        <span style="color:#bd93f9">30</span>A CROMWELL ST  CENTRAL
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">01</span> <span style="color:#bd93f9">10</span>:<span style="color:#bd93f9">42</span>:<span style="color:#bd93f9">00</span>       MAZDA DEMIO       SULTAN LN         <span style="color:#bd93f9">230</span> SYMONDS ST  CENTRAL
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">01</span> <span style="color:#bd93f9">11</span>:<span style="color:#bd93f9">49</span>:<span style="color:#bd93f9">00</span>   TOYOTA VANGUARD    <span style="color:#bd93f9">1</span> WAIOHUA RD         <span style="color:#bd93f9">230</span> SYMONDS ST  CENTRAL
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2016</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">08</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">01</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">18</span>:<span style="color:#bd93f9">00</span>       TOYOTA VITZ       CAWLEY ST         <span style="color:#bd93f9">230</span> SYMONDS ST  CENTRAL
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">...</span>                               <span style="color:#ff79c6">...</span>             <span style="color:#ff79c6">...</span>                    <span style="color:#ff79c6">...</span>      <span style="color:#ff79c6">...</span>
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2019</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">07</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">03</span> <span style="color:#bd93f9">12</span>:<span style="color:#bd93f9">57</span>:<span style="color:#bd93f9">00</span>  HOLDEN COMMODORE     BEVERLEY RD           <span style="color:#bd93f9">18</span> COWLEY PL    RURAL
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2019</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">07</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">03</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">45</span>:<span style="color:#bd93f9">00</span>      SUZUKI SWIFT        ADAMS DR               ADAMS DR    RURAL
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2019</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">07</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">12</span> <span style="color:#bd93f9">12</span>:<span style="color:#bd93f9">01</span>:<span style="color:#bd93f9">00</span>        FIAT PUNTO  <span style="color:#bd93f9">2</span> BERDINNER RD  <span style="color:#bd93f9">22</span> HENDERSON VALLEY R    RURAL
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2019</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">07</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">21</span> <span style="color:#bd93f9">13</span>:<span style="color:#bd93f9">00</span>:<span style="color:#bd93f9">00</span>         MAZDA MPV       PURIRI RD           <span style="color:#bd93f9">61</span> CROOKS RD    RURAL
</span></span><span style="display:flex;"><span><span style="color:#bd93f9">2019</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">07</span><span style="color:#ff79c6">-</span><span style="color:#bd93f9">23</span> <span style="color:#bd93f9">21</span>:<span style="color:#bd93f9">05</span>:<span style="color:#bd93f9">00</span>    TOYOTA, ESTIMA    <span style="color:#bd93f9">9</span> FLAVELL DR           <span style="color:#bd93f9">7</span> FLAVELL DR    RURAL
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#bd93f9">49174</span> rows x <span style="color:#bd93f9">4</span> columns]
</span></span></code></pre></div><p>Now we&rsquo;re ready to export it:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff79c6">&gt;&gt;&gt;</span> <span style="color:#ff79c6">import</span> sqlite3
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">&gt;&gt;&gt;</span> <span style="color:#ff79c6">with</span> sqlite3<span style="color:#ff79c6">.</span>connect(<span style="color:#f1fa8c">&#39;towing.db&#39;</span>) <span style="color:#ff79c6">as</span> conn:
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">...</span>     df<span style="color:#ff79c6">.</span>to_sql(<span style="color:#f1fa8c">&#39;towing&#39;</span>, conn)
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">...</span>
</span></span></code></pre></div><p>You should now have a file called <code>towing.db</code> sitting in the same directory that you opened your Python REPL.</p>
<p>You might want to use a GUI tool like <a href="https://sqlitebrowser.org/">DB Browser for SQLite</a> to play around with it. You might notice that we&rsquo;ve still got some data that isn&rsquo;t quite right and such is the life of data analysis I suppose. I wouldn&rsquo;t know since I&rsquo;m just a hobbyist, hahaha.</p>
<p>Let&rsquo;s run a sample query to see the top 5 cars just to cap this post off once and for all:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#ff79c6">SELECT</span> vehicle, <span style="color:#ff79c6">COUNT</span>(<span style="color:#ff79c6">*</span>) <span style="color:#ff79c6">AS</span> <span style="color:#ff79c6">count</span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">FROM</span> towing
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">GROUP</span> <span style="color:#ff79c6">BY</span> vehicle
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">ORDER</span> <span style="color:#ff79c6">BY</span> <span style="color:#ff79c6">count</span> DEST
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">LIMIT</span> <span style="color:#bd93f9">5</span>
</span></span></code></pre></div><p>We get the following table back:</p>
<table>
<thead>
<tr>
<th>Vehicle</th>
<th>Count</th>
</tr>
</thead>
<tbody>
<tr>
<td>TOYOTA COROLLA</td>
<td>2103</td>
</tr>
<tr>
<td>SUZUKI SWIFT</td>
<td>1602</td>
</tr>
<tr>
<td>NISSAN TILDA</td>
<td>1251</td>
</tr>
<tr>
<td>VOLKSWAGEN GOLF</td>
<td>1146</td>
</tr>
<tr>
<td>HONDA FIT</td>
<td>1089</td>
</tr>
</tbody>
</table>
<p>Very cool. Personally, I&rsquo;m rubbish at SQL so this should be a fun dataset to experiment with.</p>

  </div>
</article>

    </div>
    <div id="fullscreen"></div>
  
  
  
  
  
  
  <script defer type="text/javascript" src="/js/footnotes.1be9fd05e6f9672cdc2b4f8c9a16b96016b4941e68d5ebe04a863454f8f64122.js" integrity="sha256-G&#43;n9Beb5ZyzcK0&#43;Mmha5YBa0lB5o1evgSoY0VPj2QSI="></script>

  
  
  
  
  <script defer type="text/javascript" src="/js/image-viewer.90762074c5e8b05c4d401ecb428a34fb7215f4d42d42eb93eff0f6bda5416a6d.js" integrity="sha256-kHYgdMXosFxNQB7LQoo0&#43;3IV9NQtQuuT7/D2vaVBam0="></script>

</body>
</html>
