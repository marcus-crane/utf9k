{{ define "main" }}
<article class="prose lg:prose-xl dark:prose-dark">
  <header>
    <h1>{{ .Title }}</h1>
    <time datetime="{{ .Date }}">{{ if .Draft }}This is an unpublished draft{{ else }}{{ .Date.Format "January 2, 2006" }}{{ end }}</time> {{ if .Draft }} · <time datetime="{{ .Date }}">Last modified {{ .Lastmod.Format "January 2, 2006" }}{{ end }} · Around {{ .ReadingTime }} minute{{ if ne .ReadingTime 1 }}s{{ end }}
  </header>
  <div id="post-body">
    {{ partial "toc.html" . }}
    {{ .Content }}
  </div>
  <hr />
  <span id="plusone" class="text-sm">
    Did you like this post? <a id="saythanks" href="#liked">Click here</a> to let me know anonymously or <a href="/privacy">see some proof of anonymity</a> first. 
  </span>
</article>
{{ end }}

{{ define "json+ld" }}
{{ if eq .Draft false }}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "{{ .Title }}",
  "datePublished": "{{ .Date.Format "2006-01-02T15:04:05-00:00" }}"
}
</script>
{{ end }}
{{ end }}

{{ define "script" }}
  {{ $targetPath := "js/thanks.js" }}
  {{ $defines := dict "process.env.NODE_ENV" `"production"` }}
  {{ $opts := dict "targetPath" $targetPath "defines" $defines }}
  {{ $built := resources.Get $targetPath | js.Build $opts | fingerprint }}
  <script type="text/javascript" src="{{ $built.RelPermalink }}" integrity="{{ $built.Data.Integrity }}" defer></script>
{{ end }}
