<!doctype html>
<html lang="en">
  <head>
    <title>utf9k</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="theme-color" content="#eaebe3" media="(prefers-color-scheme: light)" />
    <meta name="theme-color" content="#1f2738" media="(prefers-color-scheme: dark)" />
    <meta name="author" content="Marcus Crane" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no" />
    <link rel="shortcut icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" href="/favicon.png" sizes="16x16" />
    <link rel="apple-touch-icon" href="/favicon.png" />
    <link rel="me" href="mailto:hello@utf9k.net" />
    <link rel="me" href="https://mastodon.nz/@utf9k" />
    <link rel="me" href="https://twitter.com/sentreh" />
    <link rel="me" href="https://github.com/marcus-crane" />
    <link rel="webmention" href="https://webmention.io/utf9k.net/webmention" />
    <link rel="pingback" href="https://webmention.io/utf9k.net/xmlrpc" />
    <link rel="stylesheet" href="https://unpkg.com/littlefoot@4.0.1/dist/littlefoot.css" />
    <link rel="stylesheet" href="/css/style.css" />
  </head>
  <body>
    <header class="navigation">
      <a href="/" id="logo">
        <img src="/favicon.png" alt="utf9k" width="16px" height="16px" />
        <span>utf9k</span>
      </a>
      <nav>
        <li><a href="/blog/">Blog</a></li>
        <span>//</span>
        <li><a href="/projects/">Projects</a></li>
        <span>//</span>
        <li><a href="/about/">About</a></li>
        <span>//</span>
        <li><a href="/questions/">Questions</a></li>
        <span>//</span>
        <li><a href="/rss.xml">RSS</a></li>
      </nav>
    </header>
    <div id="content">
      <article>
        <header>
          <h1>What is using Port 5000 on macOS Monterey?</h1>
        </header>
        <div id="post-body">
          <p>
            I've been fiddling a bit with <a href="https://github.com/wailsapp/wails">Wails</a> recently and I gave the
            unreleased v2 alpha a try.
          </p>
          <p>Out of the box, it binds to Port 5000 and I was surprised to receive a <code>403 Forbidden</code>.</p>
          <p>Definitely not what I expected.</p>
          <p>
            <center>
              <figure>
                <img
                  src="https://cdn.utf9k.net/questions/macos-port-5000-monterey/403-forbidden.png"
                  alt="A Brave browser window showing 403 Forbidden when trying to view localhost port 5000"
                />
              </figure>
            </center>
          </p>
          <p>
            We can use the <code>lsof</code> utility to figure out what's holding on to Port 5000. You'll see in the
            screenshot below that I use a shell function called <code>whomport</code> but under the hood, it's running
            <code>lsof -nP i4TCP:5000 | grep LISTEN</code>. Let's see what the output looks like.
          </p>
          <p>
            <center>
              <figure>
                <img
                  src="https://cdn.utf9k.net/questions/macos-port-5000-monterey/whomport.png"
                  alt="A screenshot showing two windows. One is a Terminal with the output of a command called whomport. It shows Control Center listening on Port 5000 with the Process ID 2273. Behind the Terminal is Activity Monitor. Control Center is highlighted and indeed has the same Process ID of 2273."
                />
              </figure>
            </center>
          </p>
          <p>
            This doesn't really help us much since Control Centre could be anything but a bit of searching brings up
            that this change was introduced in macOS Monterey.
          </p>
          <p>
            In particular, there's a new setting under <code>System Preferences</code> -> <code>Sharing</code> called
            <code>Airplay Receiver</code>. Let's toggle it off.
          </p>
          <p>
            <center>
              <figure>
                <img
                  src="https://cdn.utf9k.net/questions/macos-port-5000-monterey/airplay-sharing.png"
                  alt="A screenshot showing the Sharing pane of macOS System Preferences. Airplay Receiver has been unticked."
                />
              </figure>
            </center>
          </p>
          <p>
            Once this is done, you should find Port 5000 instantly freed up. It's weird that Apple would pick such a
            commonly used port, especially for developers!
          </p>
        </div>
      </article>

      <script src="https://unpkg.com/littlefoot@4.0.1/dist/littlefoot.js" type="text/javascript"></script>
      <script type="text/javascript">
        littlefoot.littlefoot(); // Pass any littlefoot settings here.
      </script>
    </div>
    <div id="fullscreen"></div>
    <script type="module">
      import "/js/image-viewer.js";
    </script>
  </body>
</html>
